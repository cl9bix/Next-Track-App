<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Admin ‚Äî Dashboard</title>
    <style>
        body{font-family:system-ui,Arial; margin:0; background:#0b0720; color:#f0eff6}
        .wrap{max-width:900px; margin:0 auto; padding:18px}
        .card{background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); border-radius:14px; padding:14px; margin:12px 0}
        a.btn{display:inline-block; padding:10px 12px; border-radius:12px; background:rgba(255,255,255,.10); border:1px solid rgba(255,255,255,.18)}
        table{width:100%; border-collapse:collapse}
        th,td{padding:10px; border-bottom:1px solid rgba(255,255,255,.10); text-align:left}
        .muted{opacity:.75}
    </style>
</head>
<body>
<div class="wrap">
    <h2>üèÅ Admin panel</h2>
    <div class="card">
        <div><b>Club:</b> {{ club.name }} <span class="muted">(#{{ club.id }})</span></div>
        <div><b>Admin:</b> {{ admin.display_name }} <span class="muted">(tg: {{ admin.telegram_id }})</span></div>
        <div style="margin-top:12px">
            <a class="btn" href="/admin/events/new">Ôºã Create event</a>
        </div>
    </div>

    <div class="card">
        <h3 style="margin:0 0 10px 0">Events</h3>
        {% if events and events|length %}
        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Start</th>
                <th>End</th>
            </tr>
            </thead>
            <tbody>
            {% for e in events %}
            <tr>
                <td>#{{ e.id }}</td>
                <td>{{ e.title }}</td>
                <td class="muted">{{ e.start_date or "‚Äî" }}</td>
                <td class="muted">{{ e.end_date or "‚Äî" }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="muted">No events yet.</div>
        {% endif %}
    </div>
</div>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
    // auto-login via Telegram WebApp initData -> set cookie
    (async function(){
        const tg = window.Telegram?.WebApp;
        if(!tg?.initData) return;
        try{
            await fetch('/admin/session', {
                method:'POST',
                headers:{'Content-Type':'application/json'},
                body: JSON.stringify({init_data: tg.initData})
            });
        }catch(e){}
    })();
</script>
</body>
</html>
